<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta http-equiv="Access-Control-Allow-Origin" content="*" />
		<title>个人资料</title>

		<link href="resource/css/jz_amazeui.css" rel="stylesheet" type="text/css" />
		<link href="resource/css/personal.css" rel="stylesheet" type="text/css">
		<link href="resource/css/jz_info.css" rel="stylesheet" type="text/css">
		<link rel="stylesheet" href="resource/css/jz_xadmin.css">
		
		<script type="text/javascript" src="resource/jquery-3.2.1.js"></script>
	</head>
	<body>
		<b class="line"></b>
		<div class="user-info">

			<!--标题 -->
			<div class="top-header">
				<a class="icona" href="javascript:history.go(-1)">
					<img src="Picture/GlobalPicture/left.jpg" />
				</a>
				<h4>个人资料</h4>
			</div>
			<hr />

			<!--头像 -->
			<div class="user-infoPic">

				<input type="file" class="inputPic" allowexts="gif,jpeg,jpg,png,bmp" accept="image/*">
				<div class="filePic" align="center">
					<img class="am-circle am-img-thumbnail" src="Picture/GlobalPicture/1.jpg" alt="" />
				</div>
				<!-- <p class="am-form-help">头像</p> -->
				<div class="info-m">
					<div><b>用户名：<i id="accountName"></i></b></div>
				</div>
			</div>

			<!--个人信息 -->
			<div class="info-main">
				<form class="am-form am-form-horizontal" id="editUserForm">
					<input type="hidden" name="id" id="id" value="1" />
					<!-- <div class="am-form-group" border-bottom="2px">
						<label for="user-name2" class="am-form-label">昵称</label>
						<div class="am-form-content">
							<input type="text" name="user_nickname" id="user_nickname" placeholder="nickname">
						</div>
					</div> -->
					<div class="am-form-group">
						<label for="user-name" class="am-form-label">姓名</label>
						<div class="am-form-content">
							<input type="text" name="user_name" id="user_name" placeholder="name">
						</div>
					</div>
					<div class="am-form-group">
						<label class="am-form-label">性别</label>
						<div class="am-form-content sex">
							<label class="am-radio-inline">
								<input type="radio" name="sex" id="man" value="1" radio data-am-ucheck> 男
							</label>
							<label class="am-radio-inline">
								<input type="radio" name="sex" id="woman" value="2" data-am-ucheck> 女
							</label>
						</div>
					</div>

					<div class="am-form-group">
						<label for="user-birth" class="am-form-label">生日</label>
						<div class="am-form-content birth">
							<input type="date" name="birthday" id="birthday" />
						</div>
					</div>
					<div class="am-form-group">
						<label for="user-phone" class="am-form-label">电话</label>
						<div class="am-form-content">
							<input type="tel" name="phone" id="phone" placeholder="telephonenumber">
						</div>
					</div>
					<div class="am-form-group">
						<label for="user-email" class="am-form-label">电子邮件</label>
						<div class="am-form-content">
							<input type="email" name="email" id="email" placeholder="Email">
						</div>
					</div>
					<div class="am-form-group">
						<label for="user-address" class="am-form-label">地址</label>
						<div class="am-form-content">
							<input type="text" name="address_id" id="address_id" placeholder="address">
						</div>
					</div>
					<div class="info-btn">
						<div class="am-btn am-btn-danger" onclick="baocun()">保存修改</div>
					</div>
				</form>
			</div>
		</div>
	</body>
</html>

<script>
		var storage=window.localStorage;
		var json=storage.getItem("userInfo");
		var userInfo=JSON.parse(json);
	$(function() {
		var userId=userInfo.id;
		/* 回显用户信息 */
		$.ajax({
			url: commonJavaUrl+"Info/echoUserInfo",
			data: {
				"userId": userId
			},
			dataType: 'json', //服务器返回json格式数据
			type: 'post', //HTTP请求类型
			success: function(data) {
				if (data != null) {
					$("#user_name").val(data.userName);
					$("#birthday").val(data.birthday);
					$("#phone").val(data.phone);
					$("#email").val(data.email);
					$("#address_id").val(data.name);
					if (data.sex == 1) {
						$("#man").attr("checked",true);
					} else{
						$("#woman").attr("checked",true);
					}
					$("#accountName").html(data.accountName);
					console.log(data);
				}
			},error: function(data) {
				alert("查询失败!");
			}
		});
	})
	function baocun(){
		$.ajax({
			url: commonJavaUrl+"Info/editUserInfo",
			data: $("#editUserForm").serialize(),
			dataType: 'json', //服务器返回json格式数据
			type: 'post', //HTTP请求类型
			success: function(data) {
				if (data != null) {
					alert("修改成功");
					window.location.reload();
				}
			},error: function(data) {
				alert("修改失败!");
			}
		})
	}
</script>
